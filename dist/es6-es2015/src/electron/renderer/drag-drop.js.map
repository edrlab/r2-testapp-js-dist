{"version":3,"file":"drag-drop.js","sourceRoot":"","sources":["../../../../../src/electron/renderer/drag-drop.ts"],"names":[],"mappings":";;AAOA,uCAAuC;AAEvC,6CAG0B;AAE1B,SAAgB,aAAa;IACzB,MAAM,CAAC,QAAQ,CAAC,gBAAgB,CAAC,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE;QAChD,EAAE,CAAC,cAAc,EAAE,CAAC;QACpB,OAAO,KAAK,CAAC;IACjB,CAAC,EAAE,KAAK,CAAC,CAAC;IAEV,MAAM,CAAC,QAAQ,CAAC,gBAAgB,CAAC,MAAM,EAAE,CAAC,EAAa,EAAE,EAAE;QACvD,EAAE,CAAC,cAAc,EAAE,CAAC;QAEpB,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE;YAClB,OAAO;SACV;QAED,IAAI,SAA6B,CAAC;QAClC,IAAI,EAAE,CAAC,YAAY,CAAC,KAAK,EAAE;YACvB,KAAK,MAAM,IAAI,IAAI,EAAE,CAAC,YAAY,CAAC,KAAK,EAAE;gBACtC,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,EAAE;oBACtB,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;oBAC9B,IAAI,IAAI,EAAE;wBACN,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBACvB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBACvB,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC;wBACtB,MAAM;qBACT;iBACJ;qBAAM,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,EAAE;oBAC/B,IAAI,IAAI,CAAC,IAAI,KAAK,YAAY,EAAE;wBAC5B,MAAM,IAAI,GAAG,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBAChD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;wBAClB,SAAS,GAAG,IAAI,CAAC;qBACpB;yBAAM;wBACH,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBACvB,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;qBACnD;iBACJ;qBAAM;oBACH,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBAC1B;aACJ;SACJ;aAAM,IAAI,EAAE,CAAC,YAAY,CAAC,KAAK,EAAE;YAC9B,KAAK,MAAM,IAAI,IAAI,EAAE,CAAC,YAAY,CAAC,KAAK,EAAE;gBACtC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACvB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACvB,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC;gBACtB,MAAM;aACT;SACJ;QAED,IAAI,SAAS,EAAE;YACX,MAAM,OAAO,GAA4C;gBACrD,SAAS;aACZ,CAAC;YACF,sBAAW,CAAC,IAAI,CAAC,kCAAyB,EAAE,OAAO,CAAC,CAAC;SACxD;IACL,CAAC,EAAE,KAAK,CAAC,CAAC;AACd,CAAC;AArDD,sCAqDC","sourcesContent":["// ==LICENSE-BEGIN==\n// Copyright 2017 European Digital Reading Lab. All rights reserved.\n// Licensed to the Readium Foundation under one or more contributor license agreements.\n// Use of this source code is governed by a BSD-style license\n// that can be found in the LICENSE file exposed on Github (readium) in the project repository.\n// ==LICENSE-END==\n\nimport { ipcRenderer } from \"electron\";\n\nimport {\n    IEventPayload_R2_EVENT_OPEN_URL_OR_PATH,\n    R2_EVENT_OPEN_URL_OR_PATH,\n} from \"../common/events\";\n\nexport function setupDragDrop() {\n    window.document.addEventListener(\"dragover\", (ev) => {\n        ev.preventDefault();\n        return false;\n    }, false);\n\n    window.document.addEventListener(\"drop\", (ev: DragEvent) => {\n        ev.preventDefault();\n\n        if (!ev.dataTransfer) {\n            return;\n        }\n\n        let urlOrPath: string | undefined;\n        if (ev.dataTransfer.items) {\n            for (const item of ev.dataTransfer.items) {\n                if (item.kind === \"file\") {\n                    const file = item.getAsFile();\n                    if (file) {\n                        console.log(file.name);\n                        console.log(file.path);\n                        urlOrPath = file.path;\n                        break;\n                    }\n                } else if (item.kind === \"string\") {\n                    if (item.type === \"text/plain\") { // text/uri-list text/html\n                        const data = ev.dataTransfer.getData(item.type);\n                        console.log(data);\n                        urlOrPath = data;\n                    } else {\n                        console.log(item.type);\n                        console.log(ev.dataTransfer.getData(item.type));\n                    }\n                } else {\n                    console.log(item.kind);\n                }\n            }\n        } else if (ev.dataTransfer.files) {\n            for (const file of ev.dataTransfer.files) {\n                console.log(file.name);\n                console.log(file.path);\n                urlOrPath = file.path;\n                break;\n            }\n        }\n\n        if (urlOrPath) {\n            const payload: IEventPayload_R2_EVENT_OPEN_URL_OR_PATH = {\n                urlOrPath,\n            };\n            ipcRenderer.send(R2_EVENT_OPEN_URL_OR_PATH, payload);\n        }\n    }, false);\n}\n"]}