{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../../src/electron/renderer/index.ts"],"names":[],"mappings":"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","sourcesContent":["import * as path from \"path\";\n\nimport { IStringMap } from \"@models/metadata-multilang\";\nimport { Publication } from \"@models/publication\";\nimport { IEventPayload_R2_EVENT_READIUMCSS } from \"@r2-navigator-js/electron/common/events\";\nimport {\n    READIUM2_ELECTRON_HTTP_PROTOCOL,\n    convertCustomSchemeToHttpUrl,\n} from \"@r2-navigator-js/electron/common/sessions\";\nimport { getURLQueryParams } from \"@r2-navigator-js/electron/renderer/common/querystring\";\nimport {\n    DOM_EVENT_HIDE_VIEWPORT,\n    DOM_EVENT_SHOW_VIEWPORT,\n    handleLink,\n    installNavigatorDOM,\n    navLeftOrRight,\n    readiumCssOnOff as readiumCssOnOff_,\n    setReadingLocationSaver,\n    setReadiumCssJsonGetter,\n} from \"@r2-navigator-js/electron/renderer/index\";\nimport { initGlobals } from \"@r2-shared-js/init-globals\";\nimport { ipcRenderer, webFrame } from \"electron\";\nimport { JSON as TAJSON } from \"ta-json\";\n\nimport {\n    IEventPayload_R2_EVENT_LCP_LSD_RENEW,\n    IEventPayload_R2_EVENT_LCP_LSD_RENEW_RES,\n    IEventPayload_R2_EVENT_LCP_LSD_RETURN,\n    IEventPayload_R2_EVENT_LCP_LSD_RETURN_RES,\n    IEventPayload_R2_EVENT_TRY_LCP_PASS,\n    IEventPayload_R2_EVENT_TRY_LCP_PASS_RES,\n    R2_EVENT_LCP_LSD_RENEW,\n    R2_EVENT_LCP_LSD_RENEW_RES,\n    R2_EVENT_LCP_LSD_RETURN,\n    R2_EVENT_LCP_LSD_RETURN_RES,\n    R2_EVENT_TRY_LCP_PASS,\n    R2_EVENT_TRY_LCP_PASS_RES,\n} from \"../common/events\";\nimport { IStore } from \"../common/store\";\nimport { StoreElectron } from \"../common/store-electron\";\nimport {\n    IRiotOptsLinkList,\n    IRiotOptsLinkListItem,\n    IRiotTagLinkList,\n    riotMountLinkList,\n} from \"./riots/linklist/index_\";\nimport {\n    IRiotOptsLinkListGroup,\n    IRiotOptsLinkListGroupItem,\n    IRiotTagLinkListGroup,\n    riotMountLinkListGroup,\n} from \"./riots/linklistgroup/index_\";\nimport {\n    IRiotOptsLinkTree,\n    IRiotOptsLinkTreeItem,\n    IRiotTagLinkTree,\n    riotMountLinkTree,\n} from \"./riots/linktree/index_\";\nimport {\n    IRiotOptsMenuSelect,\n    IRiotOptsMenuSelectItem,\n    IRiotTagMenuSelect,\n    riotMountMenuSelect,\n} from \"./riots/menuselect/index_\";\n\nimport SystemFonts = require(\"system-font-families\");\n\nimport debounce = require(\"debounce\");\n\nconst IS_DEV = (process.env.NODE_ENV === \"development\" || process.env.NODE_ENV === \"dev\");\n\nwebFrame.registerURLSchemeAsSecure(READIUM2_ELECTRON_HTTP_PROTOCOL);\n// webFrame.registerURLSchemeAsBypassingCSP(READIUM2_ELECTRON_HTTP_PROTOCOL);\nwebFrame.registerURLSchemeAsPrivileged(READIUM2_ELECTRON_HTTP_PROTOCOL, {\n    allowServiceWorkers: false,\n    bypassCSP: false,\n    corsEnabled: false,\n    secure: true,\n    supportFetchAPI: true,\n});\n\nconst electronStore: IStore = new StoreElectron(\"readium2-testapp\", {\n    basicLinkTitles: true,\n    styling: {\n        align: \"left\",\n        colCount: \"auto\",\n        dark: false,\n        font: \"DEFAULT\",\n        fontSize: \"100%\",\n        invert: false,\n        lineHeight: \"1.5\",\n        night: false,\n        paged: false,\n        readiumcss: false,\n        sepia: false,\n    },\n});\n\nconst electronStoreLCP: IStore = new StoreElectron(\"readium2-testapp-lcp\", {});\n\n// console.log(window.location);\n// console.log(document.baseURI);\n// console.log(document.URL);\n\ninitGlobals();\n\nconst computeReadiumCssJsonMessage = (): IEventPayload_R2_EVENT_READIUMCSS => {\n\n    const on = electronStore.get(\"styling.readiumcss\");\n    if (on) {\n        const align = electronStore.get(\"styling.align\") as string;\n        const colCount = electronStore.get(\"styling.colCount\") as string;\n        const dark = electronStore.get(\"styling.dark\") as boolean;\n        const font = electronStore.get(\"styling.font\") as string;\n        const fontSize = electronStore.get(\"styling.fontSize\") as string;\n        const lineHeight = electronStore.get(\"styling.lineHeight\") as string;\n        const invert = electronStore.get(\"styling.invert\") as boolean;\n        const night = electronStore.get(\"styling.night\") as boolean;\n        const paged = electronStore.get(\"styling.paged\") as boolean;\n        const sepia = electronStore.get(\"styling.sepia\") as boolean;\n        const cssJson = {\n            align,\n            colCount,\n            dark,\n            font,\n            fontSize,\n            invert,\n            lineHeight,\n            night,\n            paged,\n            sepia,\n        };\n        const jsonMsg: IEventPayload_R2_EVENT_READIUMCSS = { injectCSS: \"yes\", setCSS: cssJson };\n        return jsonMsg;\n    } else {\n        return { injectCSS: \"rollback\", setCSS: \"rollback\" };\n    }\n};\nsetReadiumCssJsonGetter(computeReadiumCssJsonMessage);\n\nconst saveReadingLocation = (doc: string, loc: string) => {\n    let obj = electronStore.get(\"readingLocation\");\n    if (!obj) {\n        obj = {};\n    }\n    obj[pathDecoded] = {\n        doc,\n        loc,\n    };\n    electronStore.set(\"readingLocation\", obj);\n};\nsetReadingLocationSaver(saveReadingLocation);\n\nconst queryParams = getURLQueryParams();\n\n// import * as path from \"path\";\n// import { setLcpNativePluginPath } from \"@r2-streamer-js/parser/epub/lcp\";\n// // tslint:disable-next-line:no-string-literal\n// const lcpPluginBase64 = queryParams[\"lcpPlugin\"];\n// if (lcpPluginBase64) {\n//     const lcpPlugin = window.atob(lcpPluginBase64);\n//     setLcpNativePluginPath(lcpPlugin);\n// } else {\n//     setLcpNativePluginPath(path.join(process.cwd(), \"LCP\", \"lcp.node\"));\n// }\n\n// tslint:disable-next-line:no-string-literal\nconst publicationJsonUrl = queryParams[\"pub\"];\nconsole.log(publicationJsonUrl);\nconst publicationJsonUrl_ = publicationJsonUrl.startsWith(READIUM2_ELECTRON_HTTP_PROTOCOL) ?\n    convertCustomSchemeToHttpUrl(publicationJsonUrl) : publicationJsonUrl;\nconsole.log(publicationJsonUrl_);\nconst pathBase64 = publicationJsonUrl_.replace(/.*\\/pub\\/(.*)\\/manifest.json/, \"$1\");\nconsole.log(pathBase64);\nconst pathDecoded = window.atob(pathBase64);\nconsole.log(pathDecoded);\nconst pathFileName = pathDecoded.substr(\n    pathDecoded.replace(/\\\\/g, \"/\").lastIndexOf(\"/\") + 1,\n    pathDecoded.length - 1);\nconsole.log(pathFileName);\n\n// tslint:disable-next-line:no-string-literal\nconst lcpHint = queryParams[\"lcpHint\"];\n\nelectronStore.onChanged(\"styling.night\", (newValue: any, oldValue: any) => {\n    if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n        return;\n    }\n\n    const nightSwitch = document.getElementById(\"night_switch-input\") as HTMLInputElement;\n    nightSwitch.checked = newValue;\n\n    // TODO DARK THEME\n    // if (newValue) {\n    //     document.body.classList.add(\"mdc-theme--dark\");\n    // } else {\n    //     document.body.classList.remove(\"mdc-theme--dark\");\n    // }\n\n    readiumCssOnOff();\n});\n\nelectronStore.onChanged(\"styling.align\", (newValue: any, oldValue: any) => {\n    if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n        return;\n    }\n\n    const nightSwitch = document.getElementById(\"justify_switch-input\") as HTMLInputElement;\n    nightSwitch.checked = (newValue === \"justify\");\n\n    readiumCssOnOff();\n});\n\nelectronStore.onChanged(\"styling.paged\", (newValue: any, oldValue: any) => {\n    if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n        return;\n    }\n\n    const paginateSwitch = document.getElementById(\"paginate_switch-input\") as HTMLInputElement;\n    paginateSwitch.checked = newValue;\n\n    readiumCssOnOff();\n});\n\nconst readiumCssOnOff = debounce(() => {\n    readiumCssOnOff_();\n}, 500);\n\n// super hacky, but necessary :(\n// https://github.com/material-components/material-components-web/issues/1017#issuecomment-340068426\nfunction ensureSliderLayout() {\n    setTimeout(() => {\n        const fontSizeSelector = document.getElementById(\"fontSizeSelector\") as HTMLElement;\n        (fontSizeSelector as any).mdcSlider.layout();\n\n        const lineHeightSelector = document.getElementById(\"lineHeightSelector\") as HTMLElement;\n        (lineHeightSelector as any).mdcSlider.layout();\n    }, 100);\n}\n\nelectronStore.onChanged(\"styling.readiumcss\", (newValue: any, oldValue: any) => {\n    if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n        return;\n    }\n    const stylingWrapper = document.getElementById(\"stylingWrapper\") as HTMLElement;\n    stylingWrapper.style.display = newValue ? \"block\" : \"none\";\n    if (newValue) {\n        ensureSliderLayout();\n    }\n\n    const readiumcssSwitch = document.getElementById(\"readiumcss_switch-input\") as HTMLInputElement;\n    readiumcssSwitch.checked = newValue;\n\n    readiumCssOnOff();\n\n    const justifySwitch = document.getElementById(\"justify_switch-input\") as HTMLInputElement;\n    justifySwitch.disabled = !newValue;\n\n    const paginateSwitch = document.getElementById(\"paginate_switch-input\") as HTMLInputElement;\n    paginateSwitch.disabled = !newValue;\n\n    const nightSwitch = document.getElementById(\"night_switch-input\") as HTMLInputElement;\n    nightSwitch.disabled = !newValue;\n    if (!newValue) {\n        electronStore.set(\"styling.night\", false);\n    }\n});\n\nelectronStore.onChanged(\"basicLinkTitles\", (newValue: any, oldValue: any) => {\n    if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n        return;\n    }\n    const basicSwitch = document.getElementById(\"nav_basic_switch-input\") as HTMLInputElement;\n    basicSwitch.checked = !newValue;\n});\n\nlet snackBar: any;\nlet drawer: any;\n\nwindow.onerror = (err) => {\n    console.log(\"Error\", err);\n};\n\nipcRenderer.on(R2_EVENT_TRY_LCP_PASS_RES, (\n    _event: any,\n    payload: IEventPayload_R2_EVENT_TRY_LCP_PASS_RES) => {\n\n    if (!payload.okay && payload.error) {\n        let message: string;\n        if (typeof payload.error === \"string\") {\n            message = payload.error;\n        } else {\n            switch (payload.error as number) {\n                case 0: {\n                    message = \"NONE: \" + payload.error;\n                    break;\n                }\n                case 1: {\n                    message = \"INCORRECT PASSPHRASE: \" + payload.error;\n                    break;\n                }\n                case 11: {\n                    message = \"LICENSE_OUT_OF_DATE: \" + payload.error;\n                    break;\n                }\n                case 101: {\n                    message = \"CERTIFICATE_REVOKED: \" + payload.error;\n                    break;\n                }\n                case 102: {\n                    message = \"CERTIFICATE_SIGNATURE_INVALID: \" + payload.error;\n                    break;\n                }\n                case 111: {\n                    message = \"LICENSE_SIGNATURE_DATE_INVALID: \" + payload.error;\n                    break;\n                }\n                case 112: {\n                    message = \"LICENSE_SIGNATURE_INVALID: \" + payload.error;\n                    break;\n                }\n                case 121: {\n                    message = \"CONTEXT_INVALID: \" + payload.error;\n                    break;\n                }\n                case 131: {\n                    message = \"CONTENT_KEY_DECRYPT_ERROR: \" + payload.error;\n                    break;\n                }\n                case 141: {\n                    message = \"USER_KEY_CHECK_INVALID: \" + payload.error;\n                    break;\n                }\n                case 151: {\n                    message = \"CONTENT_DECRYPT_ERROR: \" + payload.error;\n                    break;\n                }\n                default: {\n                    message = \"Unknown error?! \" + payload.error;\n                }\n            }\n        }\n\n        setTimeout(() => {\n            showLcpDialog(message);\n        }, 500);\n\n        // DRMErrorCode (from r2-lcp-client)\n        // 1 === NO CORRECT PASSPHRASE / UERKEY IN GIVEN ARRAY\n        //     // No error\n        //     NONE = 0,\n        //     /**\n        //         WARNING ERRORS > 10\n        //     **/\n        //     // License is out of date (check start and end date)\n        //     LICENSE_OUT_OF_DATE = 11,\n        //     /**\n        //         CRITICAL ERRORS > 100\n        //     **/\n        //     // Certificate has been revoked in the CRL\n        //     CERTIFICATE_REVOKED = 101,\n        //     // Certificate has not been signed by CA\n        //     CERTIFICATE_SIGNATURE_INVALID = 102,\n        //     // License has been issued by an expired certificate\n        //     LICENSE_SIGNATURE_DATE_INVALID = 111,\n        //     // License signature does not match\n        //     LICENSE_SIGNATURE_INVALID = 112,\n        //     // The drm context is invalid\n        //     CONTEXT_INVALID = 121,\n        //     // Unable to decrypt encrypted content key from user key\n        //     CONTENT_KEY_DECRYPT_ERROR = 131,\n        //     // User key check invalid\n        //     USER_KEY_CHECK_INVALID = 141,\n        //     // Unable to decrypt encrypted content from content key\n        //     CONTENT_DECRYPT_ERROR = 151\n        return;\n    }\n\n    if (payload.passSha256Hex) {\n        const lcpStore = electronStoreLCP.get(\"lcp\");\n        if (!lcpStore) {\n            const lcpObj: any = {};\n            const pubLcpObj: any = lcpObj[pathDecoded] = {};\n            pubLcpObj.sha = payload.passSha256Hex;\n\n            electronStoreLCP.set(\"lcp\", lcpObj);\n        } else {\n            const pubLcpStore = lcpStore[pathDecoded];\n            if (pubLcpStore) {\n                pubLcpStore.sha = payload.passSha256Hex;\n            } else {\n                lcpStore[pathDecoded] = {\n                    sha: payload.passSha256Hex,\n                };\n            }\n            electronStoreLCP.set(\"lcp\", lcpStore);\n        }\n    }\n\n    startNavigatorExperiment();\n});\n\nlet lcpDialog: any;\n\nfunction showLcpDialog(message?: string) {\n\n    // dialog.lastFocusedTarget = evt.target;\n\n    const lcpPassHint = document.getElementById(\"lcpPassHint\") as HTMLElement;\n    lcpPassHint.textContent = lcpHint;\n\n    if (message) {\n        const lcpPassMessage = document.getElementById(\"lcpPassMessage\") as HTMLElement;\n        lcpPassMessage.textContent = message;\n    }\n\n    lcpDialog.show();\n    setTimeout(() => {\n        const lcpPassInput = document.getElementById(\"lcpPassInput\") as HTMLElement;\n        lcpPassInput.focus();\n        setTimeout(() => {\n            lcpPassInput.classList.add(\"no-focus-outline\");\n        }, 500);\n    }, 800);\n}\n\nfunction installKeyboardMouseFocusHandler() {\n    let dateLastKeyboardEvent = new Date();\n    let dateLastMouseEvent = new Date();\n\n    // // DEBUG\n    // document.body.addEventListener(\"focus\", (ev: any) => {\n    //     console.log(\"focus:\");\n    //     console.log(ev.target);\n    //     if (ev.target.tagName.toLowerCase() === \"webview\") {\n    //         console.log(\"preventing...\");\n    //         ev.preventDefault();\n    //         ev.stopPropagation();\n    //     }\n    // }, true);\n    // document.body.addEventListener(\"focusin\", (ev: any) => {\n    //     console.log(\"focusin:\");\n    //     console.log(ev.target);\n    //     if (ev.target.tagName.toLowerCase() === \"webview\") {\n    //         console.log(\"preventing...\");\n    //         ev.preventDefault();\n    //         ev.stopPropagation();\n    //     }\n    // });\n    // // DEBUG\n\n    document.body.addEventListener(\"focusin\", debounce((ev: any) => {\n        const focusWasTriggeredByMouse = dateLastMouseEvent > dateLastKeyboardEvent;\n        if (focusWasTriggeredByMouse) {\n            if (ev.target && ev.target.classList) {\n                ev.target.classList.add(\"no-focus-outline\");\n            }\n        }\n    }, 500));\n    document.body.addEventListener(\"focusout\", (ev: any) => {\n        if (ev.target && ev.target.classList) {\n            ev.target.classList.remove(\"no-focus-outline\");\n        }\n    });\n    document.body.addEventListener(\"mousedown\", () => {\n        dateLastMouseEvent = new Date();\n    });\n    document.body.addEventListener(\"keydown\", () => {\n        dateLastKeyboardEvent = new Date();\n    });\n}\n\nconst initLineHeightSelector = () => {\n\n    const lineHeightSelector = document.getElementById(\"lineHeightSelector\") as HTMLElement;\n    const slider = new (window as any).mdc.slider.MDCSlider(lineHeightSelector);\n    (lineHeightSelector as any).mdcSlider = slider;\n    // const step = lineHeightSelector.getAttribute(\"data-step\") as string;\n    // console.log(\"step: \" + step);\n    // slider.step = parseFloat(step);\n    // console.log(\"slider.step: \" + slider.step);\n\n    slider.disabled = !electronStore.get(\"styling.readiumcss\");\n    const val = electronStore.get(\"styling.lineHeight\");\n    if (val) {\n        slider.value = parseFloat(val) * 100;\n    } else {\n        slider.value = 1.5 * 100;\n    }\n\n    // console.log(slider.min);\n    // console.log(slider.max);\n    // console.log(slider.value);\n    // console.log(slider.step);\n\n    electronStore.onChanged(\"styling.readiumcss\", (newValue: any, oldValue: any) => {\n        if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n            return;\n        }\n        slider.disabled = !newValue;\n    });\n\n    // slider.listen(\"MDCSlider:input\", (event: any) => {\n    //     console.log(event.detail.value);\n    // });\n    slider.listen(\"MDCSlider:change\", (event: any) => {\n        electronStore.set(\"styling.lineHeight\",\n            \"\" + (event.detail.value / 100));\n    });\n\n    electronStore.onChanged(\"styling.lineHeight\", (newValue: any, oldValue: any) => {\n        if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n            return;\n        }\n\n        slider.value = parseFloat(newValue) * 100;\n\n        readiumCssOnOff();\n    });\n};\n\nconst initFontSizeSelector = () => {\n\n    const fontSizeSelector = document.getElementById(\"fontSizeSelector\") as HTMLElement;\n    const slider = new (window as any).mdc.slider.MDCSlider(fontSizeSelector);\n    (fontSizeSelector as any).mdcSlider = slider;\n\n    // const drawerElement = document.getElementById(\"drawer\") as HTMLElement;\n    // const funcClose = () => {\n    //     drawerElement.removeEventListener(\"MDCTemporaryDrawer:close\", funcClose);\n    //     console.log(\"MDCTemporaryDrawer:close\");\n\n    //     const funcOpen = () => {\n    //         drawerElement.removeEventListener(\"MDCTemporaryDrawer:open\", funcOpen);\n    //         console.log(\"MDCTemporaryDrawer:open\");\n\n    //         setTimeout(() => {\n    //             console.log(\"SLIDER LAYOUT\");\n    //             slider.layout();\n    //         }, 1000);\n    //     };\n    //     drawerElement.addEventListener(\"MDCTemporaryDrawer:open\", funcOpen);\n    // };\n    // drawerElement.addEventListener(\"MDCTemporaryDrawer:close\", funcClose);\n\n    slider.disabled = !electronStore.get(\"styling.readiumcss\");\n    const val = electronStore.get(\"styling.fontSize\");\n    if (val) {\n        slider.value = parseInt(val.replace(\"%\", \"\"), 10);\n    } else {\n        slider.value = 100;\n    }\n\n    // console.log(slider.min);\n    // console.log(slider.max);\n    // console.log(slider.value);\n    // console.log(slider.step);\n\n    electronStore.onChanged(\"styling.readiumcss\", (newValue: any, oldValue: any) => {\n        if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n            return;\n        }\n        slider.disabled = !newValue;\n    });\n\n    // slider.listen(\"MDCSlider:input\", (event: any) => {\n    //     console.log(event.detail.value);\n    // });\n    slider.listen(\"MDCSlider:change\", (event: any) => {\n        // console.log(event.detail.value);\n        electronStore.set(\"styling.fontSize\", event.detail.value + \"%\");\n    });\n\n    electronStore.onChanged(\"styling.fontSize\", (newValue: any, oldValue: any) => {\n        if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n            return;\n        }\n\n        slider.value = parseInt(newValue.replace(\"%\", \"\"), 10);\n\n        readiumCssOnOff();\n    });\n};\n\nconst initFontSelector = () => {\n\n    const ID_PREFIX = \"fontselect_\";\n\n    const options: IRiotOptsMenuSelectItem[] =\n        [{\n            id: ID_PREFIX + \"DEFAULT\",\n            label: \"Default font\",\n        }, {\n            id: ID_PREFIX + \"OLD\",\n            label: \"Old Style\",\n            style: \"font-family: \\\"Iowan Old Style\\\", \\\"Sitka Text\\\", Palatino, \\\"Book Antiqua\\\", serif;\",\n        }, {\n            id: ID_PREFIX + \"MODERN\",\n            label: \"Modern\",\n            style: \"font-family: Athelas, Constantia, Georgia, serif;\",\n        }, {\n            id: ID_PREFIX + \"SANS\",\n            label: \"Sans\",\n            style: \"font-family: -apple-system, system-ui, BlinkMacSystemFont,\" +\n                \" \\\"Segoe UI\\\", Roboto, \\\"Helvetica Neue\\\", Arial, sans-serif;\",\n        }, {\n            id: ID_PREFIX + \"HUMAN\",\n            label: \"Humanist\",\n            style: \"font-family: Seravek, Calibri, Roboto, Arial, sans-serif;\",\n        }, {\n            id: ID_PREFIX + \"DYS\",\n            label: \"Readable (dys)\",\n            style: \"font-family: AccessibleDfa;\",\n        }, {\n            id: ID_PREFIX + \"MONO\",\n            label: \"Monospace\",\n            style: \"font-family: \\\"Andale Mono\\\", Consolas, monospace;\",\n        }];\n    let selectedID = ID_PREFIX + electronStore.get(\"styling.font\");\n    const foundItem = options.find((item) => {\n        return item.id === selectedID;\n    });\n    if (!foundItem) {\n        selectedID = options[0].id;\n    }\n    const opts: IRiotOptsMenuSelect = {\n        disabled: !electronStore.get(\"styling.readiumcss\"),\n        label: \"Font name\",\n        options,\n        selected: selectedID,\n    };\n    const tag = riotMountMenuSelect(\"#fontSelect\", opts)[0] as IRiotTagMenuSelect;\n\n    tag.on(\"selectionChanged\", (val: string) => {\n        // console.log(\"selectionChanged\");\n        // console.log(val);\n        // const element = tag.root.ownerDocument.getElementById(val) as HTMLElement;\n        //     console.log(element.textContent);\n        val = val.replace(ID_PREFIX, \"\");\n        // console.log(val);\n        electronStore.set(\"styling.font\", val);\n    });\n\n    electronStore.onChanged(\"styling.font\", (newValue: any, oldValue: any) => {\n        if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n            return;\n        }\n        // console.log(\"onDidChange\");\n        // console.log(newValue);\n        tag.setSelectedItem(ID_PREFIX + newValue);\n\n        readiumCssOnOff();\n    });\n\n    electronStore.onChanged(\"styling.readiumcss\", (newValue: any, oldValue: any) => {\n        if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n            return;\n        }\n        tag.setDisabled(!newValue);\n    });\n\n    setTimeout(async () => {\n\n        let _sysFonts: string[] = [];\n        const systemFonts = new SystemFonts.default();\n        // const sysFonts = systemFonts.getFontsSync();\n        try {\n            _sysFonts = await systemFonts.getFonts();\n            // console.log(_sysFonts);\n        } catch (err) {\n            console.log(err);\n        }\n        if (_sysFonts && _sysFonts.length) {\n            const arr = ((tag.opts as IRiotOptsMenuSelect).options as IRiotOptsMenuSelectItem[]);\n            const divider: IRiotOptsMenuSelectItem = {\n                id: ID_PREFIX + \"_\",\n                label: \"_\",\n            };\n            arr.push(divider);\n            _sysFonts.forEach((sysFont) => {\n                const option: IRiotOptsMenuSelectItem = {\n                    id: ID_PREFIX + sysFont, // .replace(/ /g, \"_\"),\n                    label: sysFont,\n                    style: \"font-family: \" + sysFont + \";\",\n                };\n                arr.push(option);\n            });\n            let newSelectedID = ID_PREFIX + electronStore.get(\"styling.font\");\n            const newFoundItem = options.find((item) => {\n                return item.id === newSelectedID;\n            });\n            if (!newFoundItem) {\n                newSelectedID = arr[0].id;\n            }\n            (tag.opts as IRiotOptsMenuSelect).selected = newSelectedID;\n            tag.update();\n        }\n    }, 100);\n};\n\n// window.addEventListener(\"load\", () => {\n// });\n\nwindow.addEventListener(\"DOMContentLoaded\", () => {\n\n    (window as any).mdc.menu.MDCMenuFoundation.numbers.TRANSITION_DURATION_MS = 200;\n\n    // TODO this seems to hijack MDC slider thumb change\n    window.document.addEventListener(\"keydown\", (ev: KeyboardEvent) => {\n        if (drawer.open) {\n            return;\n        }\n        if ((ev.target as any).mdcSlider) {\n            return;\n        }\n\n        if (ev.keyCode === 37) { // left\n            navLeftOrRight(true);\n        } else if (ev.keyCode === 39) { // right\n            navLeftOrRight(false);\n        }\n    });\n\n    setTimeout(() => {\n        // material-components-web\n        (window as any).mdc.autoInit();\n    }, 500);\n\n    window.document.title = \"Readium2 [ \" + pathFileName + \"]\";\n\n    const h1 = document.getElementById(\"pubTitle\") as HTMLElement;\n    h1.textContent = pathFileName;\n\n    installKeyboardMouseFocusHandler();\n\n    // TODO DARK THEME\n    // if (electronStore.get(\"styling.night\")) {\n    //     document.body.classList.add(\"mdc-theme--dark\");\n    // } else {\n    //     document.body.classList.remove(\"mdc-theme--dark\");\n    // }\n\n    const drawerElement = document.getElementById(\"drawer\") as HTMLElement;\n    drawer = new (window as any).mdc.drawer.MDCTemporaryDrawer(drawerElement);\n    (drawerElement as any).mdcTemporaryDrawer = drawer;\n    const drawerButton = document.getElementById(\"drawerButton\") as HTMLElement;\n    drawerButton.addEventListener(\"click\", () => {\n        drawer.open = true;\n    });\n    // drawerElement.addEventListener(\"click\", (ev) => {\n    //     const allMenus = drawerElement.querySelectorAll(\".mdc-menu\");\n    //     const openedMenus: Node[] = [];\n    //     allMenus.forEach((elem) => {\n    //         if ((elem as any).mdcSimpleMenu && (elem as any).mdcSimpleMenu.open) {\n    //             openedMenus.push(elem);\n    //         }\n    //     });\n\n    //     let needsToCloseMenus = true;\n    //     let currElem: Node | null = ev.target as Node;\n    //     while (currElem) {\n    //         if (openedMenus.indexOf(currElem) >= 0) {\n    //             needsToCloseMenus = false;\n    //             break;\n    //         }\n    //         currElem = currElem.parentNode;\n    //     }\n    //     if (needsToCloseMenus) {\n    //         openedMenus.forEach((elem) => {\n    //             (elem as any).mdcSimpleMenu.open = false;\n    //             let ss = (elem.parentNode as HTMLElement).querySelector(\".mdc-select__selected-text\");\n    //             if (ss) {\n    //                 (ss as HTMLElement).style.transform = \"initial\";\n    //                 (ss as HTMLElement).style.opacity = \"1\";\n    //                 (ss as HTMLElement).focus();\n    //             }\n    //             ss = (elem.parentNode as HTMLElement).querySelector(\".mdc-select__label\");\n    //             if (ss) {\n    //                 (ss as HTMLElement).style.transform = \"initial\";\n    //                 (ss as HTMLElement).style.opacity = \"1\";\n    //                 (ss as HTMLElement).focus();\n    //             }\n    //         });\n    //     } else {\n    //         console.log(\"NOT CLOSING MENU\");\n    //     }\n    // }, true);\n\n    initFontSelector();\n    initFontSizeSelector();\n    initLineHeightSelector();\n\n    const nightSwitch = document.getElementById(\"night_switch-input\") as HTMLInputElement;\n    nightSwitch.checked = electronStore.get(\"styling.night\");\n    nightSwitch.addEventListener(\"change\", (_event) => {\n        const checked = nightSwitch.checked;\n        electronStore.set(\"styling.night\", checked);\n    });\n    nightSwitch.disabled = !electronStore.get(\"styling.readiumcss\");\n\n    const justifySwitch = document.getElementById(\"justify_switch-input\") as HTMLInputElement;\n    justifySwitch.checked = electronStore.get(\"styling.align\") === \"justify\";\n    justifySwitch.addEventListener(\"change\", (_event) => {\n        const checked = justifySwitch.checked;\n        electronStore.set(\"styling.align\", checked ? \"justify\" : \"initial\");\n    });\n    justifySwitch.disabled = !electronStore.get(\"styling.readiumcss\");\n\n    const paginateSwitch = document.getElementById(\"paginate_switch-input\") as HTMLInputElement;\n    paginateSwitch.checked = electronStore.get(\"styling.paged\");\n    paginateSwitch.addEventListener(\"change\", (_event) => {\n        const checked = paginateSwitch.checked;\n        electronStore.set(\"styling.paged\", checked);\n    });\n    paginateSwitch.disabled = !electronStore.get(\"styling.readiumcss\");\n\n    const readiumcssSwitch = document.getElementById(\"readiumcss_switch-input\") as HTMLInputElement;\n    readiumcssSwitch.checked = electronStore.get(\"styling.readiumcss\");\n    const stylingWrapper = document.getElementById(\"stylingWrapper\") as HTMLElement;\n    stylingWrapper.style.display = readiumcssSwitch.checked ? \"block\" : \"none\";\n    if (readiumcssSwitch.checked) {\n        ensureSliderLayout();\n    }\n    readiumcssSwitch.addEventListener(\"change\", (_event) => {\n        const checked = readiumcssSwitch.checked;\n        electronStore.set(\"styling.readiumcss\", checked);\n    });\n\n    const basicSwitch = document.getElementById(\"nav_basic_switch-input\") as HTMLInputElement;\n    basicSwitch.checked = !electronStore.get(\"basicLinkTitles\");\n    basicSwitch.addEventListener(\"change\", (_event) => {\n        const checked = basicSwitch.checked;\n        electronStore.set(\"basicLinkTitles\", !checked);\n    });\n\n    const snackBarElem = document.getElementById(\"snackbar\") as HTMLElement;\n    snackBar = new (window as any).mdc.snackbar.MDCSnackbar(snackBarElem);\n    (snackBarElem as any).mdcSnackbar = snackBar;\n    snackBar.dismissesOnAction = true;\n\n    //     drawerElement.addEventListener(\"MDCTemporaryDrawer:open\", () => {\n    //         console.log(\"MDCTemporaryDrawer:open\");\n    //     });\n    //     drawerElement.addEventListener(\"MDCTemporaryDrawer:close\", () => {\n    //         console.log(\"MDCTemporaryDrawer:close\");\n    //     });\n\n    const menuFactory = (menuEl: HTMLElement) => {\n        const menu = new (window as any).mdc.menu.MDCMenu(menuEl);\n        (menuEl as any).mdcSimpleMenu = menu;\n        return menu;\n    };\n\n    const selectElement = document.getElementById(\"nav-select\") as HTMLElement;\n    const navSelector = new (window as any).mdc.select.MDCSelect(selectElement, undefined, menuFactory);\n    (selectElement as any).mdcSelect = navSelector;\n    navSelector.listen(\"MDCSelect:change\", (ev: any) => {\n        // console.log(\"MDCSelect:change\");\n        // console.log(ev);\n        // console.log(ev.detail.selectedOptions[0].textContent);\n        // console.log(ev.detail.selectedIndex);\n        // console.log(ev.detail.value);\n\n        const activePanel = document.querySelector(\".tabPanel.active\");\n        if (activePanel) {\n            activePanel.classList.remove(\"active\");\n        }\n        const newActivePanel = document.querySelector(\".tabPanel:nth-child(\" + (ev.detail.selectedIndex + 1) + \")\");\n        if (newActivePanel) {\n            newActivePanel.classList.add(\"active\");\n\n            const div = document.getElementById(\"reader_controls_STYLES\") as HTMLElement;\n            if (newActivePanel === div) {\n                ensureSliderLayout();\n            }\n        }\n    });\n\n    const diagElem = document.querySelector(\"#lcpDialog\");\n    const lcpPassInput = document.getElementById(\"lcpPassInput\") as HTMLInputElement;\n    lcpDialog = new (window as any).mdc.dialog.MDCDialog(diagElem);\n    (diagElem as any).mdcDialog = lcpDialog;\n    lcpDialog.listen(\"MDCDialog:accept\", () => {\n\n        const lcpPass = lcpPassInput.value;\n\n        const payload: IEventPayload_R2_EVENT_TRY_LCP_PASS = {\n            isSha256Hex: false,\n            lcpPass,\n            publicationFilePath: pathDecoded,\n        };\n        ipcRenderer.send(R2_EVENT_TRY_LCP_PASS, payload);\n    });\n    lcpDialog.listen(\"MDCDialog:cancel\", () => {\n\n        setTimeout(() => {\n            showLcpDialog();\n        }, 10);\n    });\n    if (lcpPassInput) {\n        lcpPassInput.addEventListener(\"keyup\", (ev) => {\n            if (ev.keyCode === 13) {\n                ev.preventDefault();\n                const lcpDialogAcceptButton = document.getElementById(\"lcpDialogAcceptButton\") as HTMLElement;\n                lcpDialogAcceptButton.click();\n            }\n        });\n    }\n\n    if (lcpHint) {\n\n        let lcpPassSha256Hex: string | undefined;\n        const lcpStore = electronStoreLCP.get(\"lcp\");\n        if (lcpStore) {\n            const pubLcpStore = lcpStore[pathDecoded];\n            if (pubLcpStore && pubLcpStore.sha) {\n                lcpPassSha256Hex = pubLcpStore.sha;\n            }\n        }\n        if (lcpPassSha256Hex) {\n            const payload: IEventPayload_R2_EVENT_TRY_LCP_PASS = {\n                isSha256Hex: true,\n                lcpPass: lcpPassSha256Hex,\n                publicationFilePath: pathDecoded,\n            };\n            ipcRenderer.send(R2_EVENT_TRY_LCP_PASS, payload);\n        } else {\n            showLcpDialog();\n        }\n    } else {\n        startNavigatorExperiment();\n    }\n\n    const buttonClearReadingLocations = document.getElementById(\"buttonClearReadingLocations\") as HTMLElement;\n    buttonClearReadingLocations.addEventListener(\"click\", () => {\n        electronStore.set(\"readingLocation\", {});\n\n        drawer.open = false;\n        setTimeout(() => {\n            const message = \"Reading locations reset.\";\n            const data = {\n                actionHandler: () => {\n                    // console.log(\"SnackBar OK\");\n                },\n                actionOnBottom: false,\n                actionText: \"OK\",\n                message,\n                multiline: false,\n                timeout: 2000,\n            };\n            snackBar.show(data);\n        }, 500);\n    });\n\n    const buttonClearSettings = document.getElementById(\"buttonClearSettings\") as HTMLElement;\n    buttonClearSettings.addEventListener(\"click\", () => {\n        // electronStore.clear();\n        // electronStore.store = electronStore.getDefaults();\n        electronStore.set(undefined, electronStore.getDefaults());\n\n        drawer.open = false;\n        setTimeout(() => {\n            const message = \"Settings reset.\";\n            const data = {\n                actionHandler: () => {\n                    // console.log(\"SnackBar OK\");\n                },\n                actionOnBottom: false,\n                actionText: \"OK\",\n                message,\n                multiline: false,\n                timeout: 2000,\n            };\n            snackBar.show(data);\n        }, 500);\n    });\n\n    const buttonClearSettingsStyle = document.getElementById(\"buttonClearSettingsStyle\") as HTMLElement;\n    buttonClearSettingsStyle.addEventListener(\"click\", () => {\n\n        electronStore.set(\"styling\", electronStore.getDefaults().styling);\n\n        drawer.open = false;\n        setTimeout(() => {\n            const message = \"Default styles.\";\n            const data = {\n                actionHandler: () => {\n                    // console.log(\"SnackBar OK\");\n                },\n                actionOnBottom: false,\n                actionText: \"OK\",\n                message,\n                multiline: false,\n                timeout: 2000,\n            };\n            snackBar.show(data);\n        }, 500);\n    });\n\n    const buttonOpenSettings = document.getElementById(\"buttonOpenSettings\") as HTMLElement;\n    buttonOpenSettings.addEventListener(\"click\", () => {\n        if ((electronStore as any).reveal) {\n            (electronStore as any).reveal();\n        }\n        if ((electronStoreLCP as any).reveal) {\n            (electronStoreLCP as any).reveal();\n        }\n    });\n\n    const buttonLSDRenew = document.getElementById(\"buttonLSDRenew\") as HTMLElement;\n    buttonLSDRenew.addEventListener(\"click\", () => {\n        const payload: IEventPayload_R2_EVENT_LCP_LSD_RENEW = {\n            endDateStr: undefined, // no explicit end date\n            publicationFilePath: pathDecoded,\n        };\n        ipcRenderer.send(R2_EVENT_LCP_LSD_RENEW, payload);\n    });\n\n    const buttonLSDReturn = document.getElementById(\"buttonLSDReturn\") as HTMLElement;\n    buttonLSDReturn.addEventListener(\"click\", () => {\n        const payload: IEventPayload_R2_EVENT_LCP_LSD_RETURN = {\n            publicationFilePath: pathDecoded,\n        };\n        ipcRenderer.send(R2_EVENT_LCP_LSD_RETURN, payload);\n    });\n\n    // const buttonDevTools = document.getElementById(\"buttonDevTools\") as HTMLElement;\n    //     buttonDevTools.addEventListener(\"click\", () => {\n    //         ipcRenderer.send(R2_EVENT_DEVTOOLS, \"test\");\n    //     });\n});\n\nipcRenderer.on(R2_EVENT_LCP_LSD_RENEW_RES, (_event: any, payload: IEventPayload_R2_EVENT_LCP_LSD_RENEW_RES) => {\n    console.log(\"R2_EVENT_LCP_LSD_RENEW_RES\");\n    console.log(payload.okay);\n    console.log(payload.error);\n    console.log(payload.lsdJson);\n});\n\nipcRenderer.on(R2_EVENT_LCP_LSD_RETURN_RES, (_event: any, payload: IEventPayload_R2_EVENT_LCP_LSD_RETURN_RES) => {\n    console.log(\"R2_EVENT_LCP_LSD_RETURN_RES\");\n    console.log(payload.okay);\n    console.log(payload.error);\n    console.log(payload.lsdJson);\n});\n\nfunction startNavigatorExperiment() {\n\n    const drawerButton = document.getElementById(\"drawerButton\") as HTMLElement;\n    drawerButton.focus();\n\n    // tslint:disable-next-line:no-floating-promises\n    (async () => {\n\n        let response: Response;\n        try {\n            response = await fetch(publicationJsonUrl);\n        } catch (e) {\n            console.log(e);\n            return;\n        }\n        if (!response.ok) {\n            console.log(\"BAD RESPONSE?!\");\n        }\n        // response.headers.forEach((arg0: any, arg1: any) => {\n        //     console.log(arg0 + \" => \" + arg1);\n        // });\n\n        let _publicationJSON: any | undefined;\n        try {\n            _publicationJSON = await response.json();\n        } catch (e) {\n            console.log(e);\n        }\n        if (!_publicationJSON) {\n            return;\n        }\n        // const pubJson = global.JSON.parse(publicationStr);\n\n        // let _publication: Publication | undefined;\n        const _publication = TAJSON.deserialize<Publication>(_publicationJSON, Publication);\n\n        if (_publication.Metadata && _publication.Metadata.Title) {\n            let title: string | undefined;\n            if (typeof _publication.Metadata.Title === \"string\") {\n                title = _publication.Metadata.Title;\n            } else {\n                const keys = Object.keys(_publication.Metadata.Title as IStringMap);\n                if (keys && keys.length) {\n                    title = (_publication.Metadata.Title as IStringMap)[keys[0]];\n                }\n            }\n\n            if (title) {\n                const h1 = document.getElementById(\"pubTitle\") as HTMLElement;\n                h1.textContent = title;\n            }\n        }\n\n        const buttonNavLeft = document.getElementById(\"buttonNavLeft\") as HTMLElement;\n        buttonNavLeft.addEventListener(\"click\", (_event) => {\n            navLeftOrRight(true);\n        });\n\n        const buttonNavRight = document.getElementById(\"buttonNavRight\") as HTMLElement;\n        buttonNavRight.addEventListener(\"click\", (_event) => {\n            navLeftOrRight(false);\n        });\n\n        if (_publication.Spine && _publication.Spine.length) {\n\n            const opts: IRiotOptsLinkList = {\n                basic: true,\n                fixBasic: true, // always single-line list items (no title)\n                handleLink: handleLink_,\n                links: _publicationJSON.spine as IRiotOptsLinkListItem[],\n                url: publicationJsonUrl,\n            };\n            // const tag =\n            riotMountLinkList(\"#reader_controls_SPINE\", opts);\n        }\n\n        if (_publication.TOC && _publication.TOC.length) {\n\n            const opts: IRiotOptsLinkTree = {\n                basic: electronStore.get(\"basicLinkTitles\"),\n                handleLink: handleLink_,\n                links: _publicationJSON.toc as IRiotOptsLinkTreeItem[],\n                url: publicationJsonUrl,\n            };\n            const tag = riotMountLinkTree(\"#reader_controls_TOC\", opts)[0] as IRiotTagLinkTree;\n\n            electronStore.onChanged(\"basicLinkTitles\", (newValue: any, oldValue: any) => {\n                if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n                    return;\n                }\n                tag.setBasic(newValue);\n            });\n        }\n        if (_publication.PageList && _publication.PageList.length) {\n\n            const opts: IRiotOptsLinkList = {\n                basic: electronStore.get(\"basicLinkTitles\"),\n                handleLink: handleLink_,\n                links: _publicationJSON[\"page-list\"] as IRiotOptsLinkListItem[],\n                url: publicationJsonUrl,\n            };\n            const tag = riotMountLinkList(\"#reader_controls_PAGELIST\", opts)[0] as IRiotTagLinkList;\n\n            electronStore.onChanged(\"basicLinkTitles\", (newValue: any, oldValue: any) => {\n                if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n                    return;\n                }\n                tag.setBasic(newValue);\n            });\n        }\n\n        const landmarksData: IRiotOptsLinkListGroupItem[] = [];\n        if (_publication.Landmarks && _publication.Landmarks.length) {\n            landmarksData.push({\n                label: \"Main\",\n                links: _publicationJSON.landmarks as IRiotOptsLinkListItem[],\n            });\n        }\n        if (_publication.LOT && _publication.LOT.length) {\n            landmarksData.push({\n                label: \"Tables\",\n                links: _publicationJSON.lot as IRiotOptsLinkListItem[],\n            });\n        }\n        if (_publication.LOI && _publication.LOI.length) {\n            landmarksData.push({\n                label: \"Illustrations\",\n                links: _publicationJSON.loi as IRiotOptsLinkListItem[],\n            });\n        }\n        if (_publication.LOV && _publication.LOV.length) {\n            landmarksData.push({\n                label: \"Video\",\n                links: _publicationJSON.lov as IRiotOptsLinkListItem[],\n            });\n        }\n        if (_publication.LOA && _publication.LOA.length) {\n            landmarksData.push({\n                label: \"Audio\",\n                links: _publicationJSON.loa as IRiotOptsLinkListItem[],\n            });\n        }\n        if (landmarksData.length) {\n            const opts: IRiotOptsLinkListGroup = {\n                basic: electronStore.get(\"basicLinkTitles\"),\n                handleLink: handleLink_,\n                linksgroup: landmarksData,\n                url: publicationJsonUrl,\n            };\n            const tag = riotMountLinkListGroup(\"#reader_controls_LANDMARKS\", opts)[0] as IRiotTagLinkListGroup;\n\n            electronStore.onChanged(\"basicLinkTitles\", (newValue: any, oldValue: any) => {\n                if (typeof newValue === \"undefined\" || typeof oldValue === \"undefined\") {\n                    return;\n                }\n                tag.setBasic(newValue);\n            });\n        }\n\n        const readStore = electronStore.get(\"readingLocation\");\n        let pubDocHrefToLoad: string | undefined;\n        let pubDocSelectorToGoto: string | undefined;\n        if (readStore) {\n            const obj = readStore[pathDecoded];\n            if (obj && obj.doc) {\n                pubDocHrefToLoad = obj.doc;\n                if (obj.loc) {\n                    pubDocSelectorToGoto = obj.loc;\n                }\n            }\n        }\n\n        // necessary otherwise focus steal for links in publication documents!\n        drawer.open = true;\n        setTimeout(() => {\n            drawer.open = false;\n\n            let preloadPath = \"./preload.js\";\n\n            // TODO: REEEALLY HACKY! (and does not work in release bundle mode, only with dist/ exploded code)\n            let distTarget: string | undefined;\n            const dirnameSlashed = __dirname.replace(/\\\\/g, \"/\");\n            if (dirnameSlashed.indexOf(\"/dist/es5\") > 0) {\n                distTarget = \"es5\";\n            } else if (dirnameSlashed.indexOf(\"/dist/es6-es2015\") > 0) {\n                distTarget = \"es6-es2015\";\n            } else if (dirnameSlashed.indexOf(\"/dist/es7-es2016\") > 0) {\n                distTarget = \"es7-es2016\";\n            } else if (dirnameSlashed.indexOf(\"/dist/es8-es2017\") > 0) {\n                distTarget = \"es8-es2017\";\n            }\n            if (distTarget) {\n                preloadPath = path.join(process.cwd(),\n                    \"node_modules/r2-navigator-js/dist/\" +\n                    distTarget\n                    + \"/src/electron/renderer/webview/preload.js\");\n            }\n\n            preloadPath = IS_DEV ? preloadPath : `${dirnameSlashed}/preload.js`;\n            preloadPath = preloadPath.replace(/\\\\/g, \"/\");\n            // preloadPath = \"file://\" + preloadPath;\n            console.log(preloadPath);\n\n            const rootHtmlElementID = \"publication_viewport\";\n            const rootHtmlElement = document.getElementById(rootHtmlElementID) as HTMLElement;\n            if (!rootHtmlElement) {\n                console.log(\"!rootHtmlElement ???\");\n                return;\n            }\n\n            rootHtmlElement.addEventListener(DOM_EVENT_HIDE_VIEWPORT, () => {\n                hideWebView();\n            });\n            rootHtmlElement.addEventListener(DOM_EVENT_SHOW_VIEWPORT, () => {\n                unhideWebView();\n            });\n\n            installNavigatorDOM(_publication, publicationJsonUrl,\n                rootHtmlElementID,\n                preloadPath,\n                pubDocHrefToLoad, pubDocSelectorToGoto);\n        }, 500);\n    })();\n}\n\nconst ELEMENT_ID_HIDE_PANEL = \"r2_navigator_reader_chrome_HIDE\";\nlet _viewHideInterval: NodeJS.Timer | undefined;\nconst unhideWebView = () => {\n    if (_viewHideInterval) {\n        clearInterval(_viewHideInterval);\n        _viewHideInterval = undefined;\n    }\n    const hidePanel = document.getElementById(ELEMENT_ID_HIDE_PANEL) as HTMLElement;\n    if (!hidePanel || hidePanel.style.display === \"none\") {\n        return;\n    }\n    if (hidePanel) {\n        hidePanel.style.display = \"none\";\n    }\n};\nconst hideWebView = () => {\n    const hidePanel = document.getElementById(ELEMENT_ID_HIDE_PANEL) as HTMLElement;\n    if (hidePanel && hidePanel.style.display !== \"block\") {\n        hidePanel.style.display = \"block\";\n        _viewHideInterval = setInterval(() => {\n            console.log(\"unhideWebView FORCED\");\n            unhideWebView();\n        }, 5000);\n    }\n};\n\nfunction handleLink_(href: string) {\n    if (drawer.open) {\n        drawer.open = false;\n        setTimeout(() => {\n            handleLink(href, undefined, false);\n        }, 200);\n    } else {\n        handleLink(href, undefined, false);\n    }\n}\n"]}