{"version":3,"file":"drag-drop.js","sourceRoot":"","sources":["../../../../../src/electron/renderer/drag-drop.ts"],"names":[],"mappings":";;;AAOA,qCAAuC;AAEvC,2CAG0B;AAE1B,SAAgB,aAAa;IACzB,MAAM,CAAC,QAAQ,CAAC,gBAAgB,CAAC,UAAU,EAAE,UAAC,EAAE;QAC5C,EAAE,CAAC,cAAc,EAAE,CAAC;QACpB,OAAO,KAAK,CAAC;IACjB,CAAC,EAAE,KAAK,CAAC,CAAC;IAEV,MAAM,CAAC,QAAQ,CAAC,gBAAgB,CAAC,MAAM,EAAE,UAAC,EAAa;;QACnD,EAAE,CAAC,cAAc,EAAE,CAAC;QAEpB,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE;YAClB,OAAO;SACV;QAED,IAAI,SAA6B,CAAC;QAClC,IAAI,EAAE,CAAC,YAAY,CAAC,KAAK,EAAE;;gBACvB,KAAmB,IAAA,KAAA,iBAAA,EAAE,CAAC,YAAY,CAAC,KAAK,CAAA,gBAAA,4BAAE;oBAArC,IAAM,IAAI,WAAA;oBACX,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,EAAE;wBACtB,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;wBAC9B,IAAI,IAAI,EAAE;4BACN,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;4BACvB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;4BACvB,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC;4BACtB,MAAM;yBACT;qBACJ;yBAAM,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,EAAE;wBAC/B,IAAI,IAAI,CAAC,IAAI,KAAK,YAAY,EAAE;4BAC5B,IAAM,IAAI,GAAG,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;4BAChD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;4BAClB,SAAS,GAAG,IAAI,CAAC;yBACpB;6BAAM;4BACH,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;4BACvB,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;yBACnD;qBACJ;yBAAM;wBACH,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;qBAC1B;iBACJ;;;;;;;;;SACJ;aAAM,IAAI,EAAE,CAAC,YAAY,CAAC,KAAK,EAAE;;gBAC9B,KAAmB,IAAA,KAAA,iBAAA,EAAE,CAAC,YAAY,CAAC,KAAK,CAAA,gBAAA,4BAAE;oBAArC,IAAM,IAAI,WAAA;oBACX,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBACvB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBACvB,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC;oBACtB,MAAM;iBACT;;;;;;;;;SACJ;QAED,IAAI,SAAS,EAAE;YACX,IAAM,OAAO,GAA4C;gBACrD,SAAS,WAAA;aACZ,CAAC;YACF,sBAAW,CAAC,IAAI,CAAC,kCAAyB,EAAE,OAAO,CAAC,CAAC;SACxD;IACL,CAAC,EAAE,KAAK,CAAC,CAAC;AACd,CAAC;AArDD,sCAqDC","sourcesContent":["// ==LICENSE-BEGIN==\n// Copyright 2017 European Digital Reading Lab. All rights reserved.\n// Licensed to the Readium Foundation under one or more contributor license agreements.\n// Use of this source code is governed by a BSD-style license\n// that can be found in the LICENSE file exposed on Github (readium) in the project repository.\n// ==LICENSE-END==\n\nimport { ipcRenderer } from \"electron\";\n\nimport {\n    IEventPayload_R2_EVENT_OPEN_URL_OR_PATH,\n    R2_EVENT_OPEN_URL_OR_PATH,\n} from \"../common/events\";\n\nexport function setupDragDrop() {\n    window.document.addEventListener(\"dragover\", (ev) => {\n        ev.preventDefault();\n        return false;\n    }, false);\n\n    window.document.addEventListener(\"drop\", (ev: DragEvent) => {\n        ev.preventDefault();\n\n        if (!ev.dataTransfer) {\n            return;\n        }\n\n        let urlOrPath: string | undefined;\n        if (ev.dataTransfer.items) {\n            for (const item of ev.dataTransfer.items) {\n                if (item.kind === \"file\") {\n                    const file = item.getAsFile();\n                    if (file) {\n                        console.log(file.name);\n                        console.log(file.path);\n                        urlOrPath = file.path;\n                        break;\n                    }\n                } else if (item.kind === \"string\") {\n                    if (item.type === \"text/plain\") { // text/uri-list text/html\n                        const data = ev.dataTransfer.getData(item.type);\n                        console.log(data);\n                        urlOrPath = data;\n                    } else {\n                        console.log(item.type);\n                        console.log(ev.dataTransfer.getData(item.type));\n                    }\n                } else {\n                    console.log(item.kind);\n                }\n            }\n        } else if (ev.dataTransfer.files) {\n            for (const file of ev.dataTransfer.files) {\n                console.log(file.name);\n                console.log(file.path);\n                urlOrPath = file.path;\n                break;\n            }\n        }\n\n        if (urlOrPath) {\n            const payload: IEventPayload_R2_EVENT_OPEN_URL_OR_PATH = {\n                urlOrPath,\n            };\n            ipcRenderer.send(R2_EVENT_OPEN_URL_OR_PATH, payload);\n        }\n    }, false);\n}\n"]}